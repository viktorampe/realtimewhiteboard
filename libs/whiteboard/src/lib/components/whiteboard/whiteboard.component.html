<div
  *ngIf="whiteboard$ | async as whiteboard"
  class="whiteboard"
  (filesDroppedEvent)="onFilesDropped($event)"
  campusImageDrag
  (tap)="onClickWhiteboard($event)"
>
  <campus-whiteboard-toolbar
    @showHideWhiteboardTools
    *ngIf="selectedCards.length"
    (deleteCards)="bulkDeleteClicked()"
    (changeSelectedColor)="changeSelectedCardsColor($event)"
    [canManage]="canManage"
  ></campus-whiteboard-toolbar>
  <div class="whiteboard__workspace__actions">
    <div
      *ngIf="canManage"
      class="whiteboard__workspace__actions__settingsbutton"
      color="primary"
      (tap)="toggleSettings()"
    >
      <mat-icon [svgIcon]="'settings'"></mat-icon>
    </div>
    <div class="whiteboard__workspace__actions__zoom">
      <mat-icon
        class="whiteboard__workspace__actions__zoom__button"
        [svgIcon]="'remove'"
      ></mat-icon>
      <div class="whiteboard__workspace__actions__zoom__separator"></div>
      <mat-icon
        class="whiteboard__workspace__actions__zoom__button"
        [svgIcon]="'plus'"
      ></mat-icon>
    </div>
  </div>
  <div
    class="whiteboard__workspace"
    (dblclick)="createCard($event)"
    (longpress)="createCard($event)"
    #workspace
  >
    <ng-container *ngIf="!isSettingsActive; else settingsView">
      <div
        @showHideCard
        class="whiteboard__workspace__container"
        *ngFor="let card of whiteboard.cards"
        cdkDrag
        [cdkDragFreeDragPosition]="{ x: card.left, y: card.top }"
        [cdkDragDisabled]="card.mode === Mode.ZOOM"
        cdkDragBoundary=".whiteboard__workspace"
        [class.zoom]="card.mode === Mode.ZOOM"
        [class.onTop]="card.mode === Mode.SELECTED"
        (cdkDragEnded)="onDragEnded($event, card)"
        (cdkDragStarted)="onDragStarted(card)"
        (tap)="onCardTapped(card)"
      >
        <campus-color-list
          @showHideColorList
          class="whiteboard__color-list"
          [mode]="card.mode"
          (selectedColor)="changeColorForCard(card, $event)"
          *ngIf="card.mode === Mode.EDIT || card.mode === Mode.SELECTED"
        ></campus-color-list>
        <campus-card-toolbar
          @showHideToolbar
          *ngIf="
            card.mode === Mode.EDIT ||
            card.mode === Mode.SELECTED ||
            card.mode === Mode.MULTISELECTSELECTED ||
            card.mode === Mode.MULTISELECT
          "
          class="whiteboard__card_toolbar"
          [mode]="card.mode"
          (clickDeleteIcon)="onDeleteCard(card)"
          (clickEditIcon)="cardEditIconClicked(card)"
          (clickFlipIcon)="cardFlipIconClicked(card)"
          (clickConfirmIcon)="cardConfirmIconClicked(card)"
          (clickMultiSelectIcon)="onSelectCard(card)"
          (clickMultiSelectSelectedIcon)="onDeselectCard(card)"
        ></campus-card-toolbar>
        <campus-card
          class="whiteboard__card"
          [description]="card.description"
          [color]="card.color"
          [image]="card.image"
          [(mode)]="card.mode"
          [viewModeImage]="card.viewModeImage"
          (update)="updateCard($event, card)"
          (removeImage)="removeImage(card)"
          (openFilePicker)="openFilePicker(filePicker)"
          (press)="onCardPressed(card)"
        ></campus-card>
        <input
          (change)="onFilePickerImageSelected($event, card)"
          type="file"
          #filePicker
          multiple="false"
          style="display: none;"
        />
      </div>
    </ng-container>
    <ng-template #settingsView>
      <div class="whiteboard__settings">
        <campus-settings
          (update)="updateSettings($event)"
          [activeColor]="whiteboard.defaultColor"
          [title]="whiteboard.title"
        ></campus-settings>
      </div>
    </ng-template>

    <div
      class="whiteboard__addbutton"
      [class.plusMinimized]="isShelfMinimized"
      (tap)="btnPlusClicked($event)"
    >
      <mat-icon [svgIcon]="'plus'"></mat-icon>
    </div>
    <div
      [class.shelfMinimized]="isShelfMinimized"
      class="whiteboard__shelf__button"
      (tap)="toggleShelf()"
      ><mat-icon [svgIcon]="'arrow-down'"></mat-icon
    ></div>
    <campus-shelf
      (cardDraggedOutsideContainer)="cardDraggedPosition($event)"
      [class.minimizedShelf]="isShelfMinimized"
      [cards]="whiteboard.shelfCards"
      [(isMinimized)]="isShelfMinimized"
    ></campus-shelf>
  </div>
  <campus-empty-state
    class="whiteboard__empty"
    *ngIf="!whiteboard.cards.length && !isSettingsActive"
    [title]="whiteboard.title ? whiteboard.title : 'Geen titel'"
    [description]="
      whiteboard.shelfCards.length
        ? 'Sleep kaartjes uit de shelf naar het bord.'
        : 'Sleep afbeeldingen naar dit bord om kaartjes te maken.'
    "
    [svgIcon]="
      true ? 'empty-state-whiteboard-empty' : 'empty-state-whiteboard-drop'
    "
  ></campus-empty-state>
</div>
