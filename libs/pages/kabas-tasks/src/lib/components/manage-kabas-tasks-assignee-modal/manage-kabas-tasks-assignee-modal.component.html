<h2 mat-dialog-title class="manage-task-assignees__title"
  >Beheren - {{ currentTaskName }}</h2
>

<div
  *ngIf="!showAdvanced"
  class="manage-task-assignees__title__date-picker__container"
>
  <div class="manage-task-assignees__title__date-picker__label">Datum</div>
  <campus-date-range-picker
    class="manage-task-assignees__title__date-picker"
    [useTime]="false"
    [initialStartDate]="default.start"
    [initialEndDate]="default.end"
    (valueChanged)="setDefaultDateRange($event)"
  ></campus-date-range-picker>
</div>

<mat-dialog-content class="manage-task-assignees__content">
  <div class="manage-task-assignees__content__add-assignees__container"
    ><campus-button
      primary
      class="manage-task-assignees__content__add-assignees__container__button"
      (click)="toggleAddAssignees()"
      >Zoeken</campus-button
    >

    <campus-manage-kabas-tasks-add-assignees
      *ngIf="showAddAssignees"
      class="manage-task-assignees__content__add-assignees"
      [classgroups]="availableTaskClassGroups$ | async"
      [groups]="availableTaskGroups$ | async"
      [students]="availableTaskStudents$ | async"
      (addedAssignees)="
        addAssignees([{ type: 'student', label: 'Alfred Jodocus' }])
      "
      >Insert assignees by clicking
      here</campus-manage-kabas-tasks-add-assignees
    >
  </div>

  <ng-container *ngIf="currentTaskAssignees$ | async as currentTaskAssignees">
    <mat-list
      *ngIf="currentTaskAssignees.length; else noContentTemplate"
      class="manage-task-assignees__content__list"
    >
      <div class="manage-task-assignees__content__list__header">
        <span>Toegewezen aan </span>
        <a
          *ngIf="!showAdvanced"
          (click)="setShowAdvanced(true)"
          class="manage-task-assignees__content__list__header__view-toggle"
          >(Gebruik verschillende datums)</a
        >
        <a
          *ngIf="showAdvanced"
          (click)="setShowAdvanced(false)"
          class="manage-task-assignees__content__list__header__view-toggle"
          >(Gebruik 1 datum)</a
        >
      </div>

      <mat-list-item
        *ngFor="let assignee of currentTaskAssignees"
        class="manage-task-assignees__content__list__item"
        [ngClass]="
          'manage-task-assignees__content__list__item--' + assignee.type
        "
      >
        <div class="manage-task-assignees__content__list__item__content">
          <div
            class="manage-task-assignees__content__list__item__content__caption"
            >{{ assignee.type }} - {{ assignee.label }}</div
          >
          <campus-date-range-picker
            *ngIf="showAdvanced"
            class="manage-task-assignees__content__list__item__content__date-picker"
            [useTime]="false"
            [initialStartDate]="assignee.start"
            [initialEndDate]="assignee.end"
            (valueChanged)="setAssignmentDate([assignee], $event)"
          ></campus-date-range-picker>

          <mat-icon
            class="manage-task-assignees__content__list__item__action
                  manage-task-assignees__content__list__item__action--show-on-hover"
            [svgIcon]="'delete'"
            (click)="removeAssignee(assignee)"
          ></mat-icon
        ></div>
      </mat-list-item>
    </mat-list>
  </ng-container>
</mat-dialog-content>

<mat-dialog-actions class="manage-task-assignees__actions">
  <campus-button
    primary
    class="manage-task-assignees__actions__button"
    (click)="onCancelButtonClick()"
    >Annuleren</campus-button
  >
  <ng-container *ngIf="areCurrentTaskAssigneesValid$ | async as canEmit">
    <campus-button
      *ngIf="canEmit"
      primary
      class="manage-task-assignees__actions__button"
      (click)="onOKButtonClick()"
      >OK</campus-button
    >
    <campus-button
      *ngIf="!canEmit"
      primary
      class="manage-task-assignees__actions__button ui-button--disabled"
      >OK</campus-button
    >
  </ng-container>
</mat-dialog-actions>

<ng-template #noContentTemplate>
  <div class="manage-task-assignees__content__list--no-content">
    <span>Er zijn geen items om weer te geven.</span>
  </div>
</ng-template>
