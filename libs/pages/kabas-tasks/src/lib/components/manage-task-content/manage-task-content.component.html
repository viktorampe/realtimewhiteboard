<campus-collapsible-sheet>
  <div aside>
    <mat-nav-list *ngIf="currentTaskParams$ | async as params">
      <mat-list-item
        data-cy="lesson-link"
        *ngFor="let toc of currentToc$ | async"
        (click)="selectTOC(toc.id, toc.depth)"
        class="manage-task-content__lesson-link"
        [class.manage-task-content__lesson-link--selected]="
          toc.id === (params.lesson ? params.lesson : params.chapter)
        "
        [ngClass]="'manage-task-content__lesson-link--depth-' + toc.depth"
      >
        <span class="manage-task-content__lesson-link__title">{{
          toc.title
        }}</span></mat-list-item
      ></mat-nav-list
    >
  </div>

  <div main class="manage-task-content__main__container">
    <div class="manage-task-content__main">
      <campus-page-header
        *ngIf="selectedBookTitle$ | async as selectedBookTitle"
        [title]="selectedBookTitle"
      ></campus-page-header>
      <div data-cy="search-filters" class="manage-task-content__filters">
        <ng-container searchPortal="searchTerm"></ng-container>
        <campus-button
          class="manage-task-content__filters__reset"
          iconClass="reset-filters"
          (click)="clearSearchFilters()"
        ></campus-button>
      </div>
      <campus-search
        [autoCompleteValues]="autoCompleteValues$ | async"
        (searchTermChangeForAutoComplete)="onAutoCompleteRequest($event)"
        [autoFocusSearchTerm]="true"
        [searchMode]="searchMode$ | async"
        [initialState]="initialSearchState$ | async"
        [searchResults]="searchResults$ | async"
        (searchState$)="onSearchStateChange($event)"
      ></campus-search>
    </div>

    <div
      class="manage-task-content__main__sidesheet"
      *ngIf="task$ | async as task"
      >Insert sidesheet here...

      <mat-list #currentContentList class="manage-task-content__list">
        <mat-list-item
          *ngFor="let taskEduContent of task.taskEduContents"
          class="manage-task-content__list__item"
        >
          <mat-icon
            class="manage-task-content__list__item__icon"
            svgIcon="drag-handle"
          ></mat-icon>

          <div
            *ngTemplateOutlet="
              contentItem;
              context: {
                fileExt:
                  taskEduContent.eduContent.publishedEduContentMetadata.fileExt,
                title: taskEduContent.eduContent.name
              }
            "
          ></div>
          <mat-icon
            class="manage-task-content__list__item__icon manage-task-content__list__item__icon--on-hover"
            svgIcon="delete"
          ></mat-icon>
        </mat-list-item>
      </mat-list>
    </div>
  </div>
</campus-collapsible-sheet>

<ng-template #contentItem let-fileExt="fileExt" let-title="title">
  <div class="manage-task-content__list__item__content">
    <mat-icon
      svgIcon="{{ fileExt != 'ludo.zip' ? 'general-file' : 'exercise' }}"
      class="manage-task-content__list__item__content__icon"
    ></mat-icon>
    <div class="manage-task-content__list__item__content__title">{{
      title
    }}</div>
  </div>
</ng-template>
