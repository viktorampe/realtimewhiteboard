<campus-page-header
  [title]="'Log in'"
  [subtitle]="'Mijn gegevens'"
  [iconClass]="'profile'"
>
</campus-page-header>

<ng-container *ngIf="(currentUser$ | async) as currentUser; else notLoggedIn">
  <div class="pages-login__form ">
    <div class="pages-login__form__title"
      >Je bent ingelogd als {{ currentUser.displayName }}</div
    >
    <div>
      <campus-button campusPrimary (click)="logout()">Log uit</campus-button>
    </div>
  </div>
</ng-container>

<ng-template #notLoggedIn>
  <div class="pages-login__form__container">
    <form
      [formGroup]="loginForm"
      class="pages-login__form"
      [class.pages-login__form--unauthorized]="hasError$ | async"
    >
      <div class="pages-login__form__title">Vul uw gebruikersgegevens in</div>
      <p class="mat-error" *ngIf="(errorFeedback$ | async) as error">{{
        error.message
      }}</p>
      <mat-form-field>
        <mat-label>Gebruikersnaam</mat-label>
        <input
          type="text"
          matInput
          formControlName="username"
          required
          (keydown)="clearError()"
        />
      </mat-form-field>

      <mat-form-field>
        <mat-label>Wachtwoord</mat-label>
        <input
          type="password"
          matInput
          formControlName="password"
          required
          (keydown)="clearError()"
        />
      </mat-form-field>

      <campus-button
        campusPrimary
        (click)="submit()"
        [class.ui-button--disabled]="!loginForm.valid"
        >Login</campus-button
      >
    </form>

    <div
      class="pages-login__form pages-login__form--presets"
      *ngIf="loginPresets && loginPresets.length"
    >
      <div class="pages-login__form__title">Vooraf ingestelde logins</div>

      <ng-container *ngFor="let preset of loginPresets">
        <campus-button
          campusPrimary
          (click)="login(preset.username, preset.password)"
        >
          {{ preset.label }}
        </campus-button>
      </ng-container>
    </div>
  </div>
</ng-template>
