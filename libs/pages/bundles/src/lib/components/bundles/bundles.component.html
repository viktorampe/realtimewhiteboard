<campus-page-bar>
  <campus-filter-text-input
    theme="dark"
    [source]="sharedInfo$ | async"
    class="pages__toolbar__filter"
  ></campus-filter-text-input>
  <div class="divider"></div>
  <campus-button
    [iconClass]="'list-view'"
    (click)="clickChangeListFormat(listFormat.LINE)"
    [class.ui-button--active]="(listFormat$ | async) === listFormat.LINE"
  ></campus-button>
  <campus-button
    [iconClass]="'grid-view'"
    (click)="clickChangeListFormat(listFormat.GRID)"
    [class.ui-button--active]="(listFormat$ | async) === listFormat.GRID"
  ></campus-button>
</campus-page-bar>

<ng-container *ngIf="(learningArea$ | async) as learningArea">
  <div
    class="campus-page pages-bundles__container"
    *ngIf="(sharedInfo$ | async) as sharedInfo"
  >
    <campus-page-header
      [title]="learningArea.name"
      [subtitle]="'Bundels'"
      [iconClass]="learningArea.icon"
    >
    </campus-page-header>

    <ng-template #noSharedInfo
      >Er zijn momenteel geen bundels voor jou klaargezet.</ng-template
    >
    <ng-container *ngIf="sharedInfo.bundles.length > 0; else: noSharedInfo">
      <ng-container
        *ngIf="(filterTextInput.result$ | async) as filteredBundlesInfo"
      >
        <div class="pages-bundles__container__bundles-count">
          {{ filteredBundlesInfo.length }} van
          <u
            class="pages-bundles__container__bundles-count__total"
            (click)="filterTextInput.clear()"
            >{{ sharedInfo.bundles.length }}</u
          >
          weergegeven
        </div>

        <div class="pages-bundles__container__bundles">
          <campus-list-view
            [listFormat]="listFormat$ | async"
            [placeHolderText]="'De toegepaste filter bevat geen resultaten'"
          >
            <campus-folder
              *ngFor="let bundleInfo of filteredBundlesInfo"
              campusListItem
              [routerLink]="[bundleInfo.bundle.id]"
              [itemCount]="bundleInfo.contentsCount"
              [title]="bundleInfo.bundle.name"
              [backgroundColor]="learningArea.color"
              [icon]="learningArea.icon"
            >
              <campus-folder-details>
                {{ bundleInfo.contentsCount }}
                {{ bundleInfo.contentsCount === 1 ? 'item' : 'items' }}
              </campus-folder-details>
            </campus-folder>
          </campus-list-view>
        </div>
      </ng-container>
    </ng-container>

    <div *ngIf="sharedInfo.books.length">
      <div>&nbsp;</div>
      <campus-page-header
        [title]="learningArea.name"
        [subtitle]="'Boeken'"
        [iconClass]="learningArea.icon"
      ></campus-page-header>
      <div class="pages-bundles__container__books-count">
        Je hebt {{ sharedInfo.books.length }}
        {{ sharedInfo.books.length === 1 ? 'boek' : 'boeken' }} voor
        {{ learningArea.name }}
      </div>
      <div class="pages-bundles__container__books">
        <campus-list-view [listFormat]="listFormat$ | async">
          <campus-content-thumbnail
            *ngFor="let book of sharedInfo.books"
            campusListItem
            [selectable]="false"
            [title]="book.name"
            [contentTypeClass]="'book'"
            [imagePath]="book.previewImage"
            [fileExtensionClass]="book.fileExtension"
          >
            <campus-button
              circle
              [iconClass]="'view-content'"
              (click)="openBook(book)"
            ></campus-button>
          </campus-content-thumbnail>
        </campus-list-view>
      </div>
    </div>
  </div>
</ng-container>
