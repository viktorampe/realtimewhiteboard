<campus-page-bar>
  <campus-filter-text-input
    theme="dark"
    [source]="taskInfo$ | async"
    class="pages__toolbar__filter"
  ></campus-filter-text-input>
  <div class="divider"></div>
  <campus-button
    [iconClass]="'list-view'"
    (click)="clickChangeListFormat(listFormat.LINE)"
    [class.ui-button--active]="(listFormat$ | async) === listFormat.LINE"
  ></campus-button>
  <campus-button
    [iconClass]="'grid-view'"
    (click)="clickChangeListFormat(listFormat.GRID)"
    [class.ui-button--active]="(listFormat$ | async) === listFormat.GRID"
  ></campus-button>
</campus-page-bar>

<ng-template #noTaskInfo>Deze taak is niet langer beschikbaar.</ng-template>

<campus-side-sheet
  #taskInstanceSidesheet
  [isOpenOnInit]="true"
  *ngIf="taskInfo$ | async as taskInfo; else noTaskInfo"
>
  <campus-side-sheet-header></campus-side-sheet-header>
  <campus-side-sheet-body>
    <ng-container
      *ngIf="list && (list.selectedItems$ | async) as selectedItems"
      [ngSwitch]="selectedItems.length"
    >
      <campus-info-panel-task
        *ngSwitchCase="0"
        [taskInfo]="taskInfo"
        [person]="taskInfo.task.teacher"
      >
      </campus-info-panel-task>
      <campus-info-panel-content *ngSwitchCase="1" [content]="selectedItems[0]">
      </campus-info-panel-content>
    </ng-container>
  </campus-side-sheet-body>

  <campus-side-sheet-page>
    <campus-page-header
      [title]="taskInfo.task.name"
      [subtitle]="taskInfo.task.description"
      [iconClass]="(learningArea$ | async)?.icon"
    >
    </campus-page-header>

    <ng-container *ngIf="(taskInfo$ | async).taskEduContents as contents">
      <ng-container *ngIf="contents.length > 0; else noTaskInstanceContents">
        <ng-container
          *ngIf="filterTextInput.result$ | async as filteredContents"
        >
          <div class="itemsAmount">
            {{ filteredContents.length }} van
            <u (click)="filterTextInput.clear()">{{ contents.length }}</u>
            weergegeven
          </div>

          <campus-list-view
            #taskInstanceListview
            [listFormat]="listFormat$ | async"
            [placeHolderText]="'De toegepaste filter bevat geen resultaten.'"
            [multiSelect]="false"
          >
            <campus-content-thumbnail
              *ngFor="let taskEduContent of filteredContents"
              campusListItem
              [dataObject]="taskEduContent.eduContent"
              [title]="taskEduContent.eduContent.name"
              [fileExtensionClass]="taskEduContent.eduContent.fileExtension"
              [fileTypeLabel]="taskEduContent.eduContent.fileTypeLabel"
              [contentTypeClass]="'task'"
            >
              <campus-button
                *ngIf="!taskEduContent.submitted; else taskEduContentSubmitted"
                circle
                [iconClass]="'exercise:open'"
                (click)="clickOpenContent(taskEduContent)"
              ></campus-button>
              <ng-template #taskEduContentSubmitted>
                <campus-button
                  button-disabled
                  circle
                  [iconClass]="'exercise:finished'"
                ></campus-button>
              </ng-template>
            </campus-content-thumbnail>
          </campus-list-view>
        </ng-container>
      </ng-container>
    </ng-container>
    <ng-template #noTaskInstanceContents
      >Deze taak bevat geen inhoud</ng-template
    >
  </campus-side-sheet-page>
</campus-side-sheet>
