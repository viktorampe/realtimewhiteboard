<campus-page-bar>
  <campus-filter-text-input
    theme="dark"
    class="pages__toolbar__filter"
    [source]="taskInstances$ | async"
  ></campus-filter-text-input>

  <div class="divider"></div>
  <campus-button
    [iconClass]="'list-view'"
    (click)="setListFormat(listFormat.LINE)"
    [class.ui-button--active]="(listFormat$ | async) === listFormat.LINE"
  ></campus-button>
  <campus-button
    [iconClass]="'grid-view'"
    (click)="setListFormat(listFormat.GRID)"
    [class.ui-button--active]="(listFormat$ | async) === listFormat.GRID"
  ></campus-button>
</campus-page-bar>

<ng-container
  *ngIf="(filterTextInput.result$ | async) as filteredTaskInstances"
>
  <div class="campus-page pages-tasks__container">
    <campus-page-header
      *ngIf="(learningArea$ | async) as learningArea"
      [title]="learningArea.name"
      [subtitle]="'Taken'"
      [iconClass]="'learning-area:' + learningArea.icon"
    >
    </campus-page-header>

    <div class="pages-tasks__container__tasks-count">
      {{ filteredTaskInstances.length }} van
      <u (click)="filterTextInput.clear()">{{
        (taskInstances$ | async)?.taskInfos.length
      }}</u>
      weergegeven
    </div>

    <campus-list-view [listFormat]="listFormat$ | async" [placeHolderText]="''">
      <campus-folder
        *ngFor="let instance of filteredTaskInstances"
        [routerLink]="[instance.taskInstance.taskId]"
        campusListItem
        progress="{{ instance.taskInstance.progress }}"
        [itemCount]="instance.taskEduContentsCount"
        [title]="instance.task.name"
        [backgroundColor]="(learningArea$ | async).color"
        [icon]="getIcon(instance.finished)"
      >
        <campus-folder-details>
          {{ instance.taskEduContentsCount + ' item(s)' }}<br />
          {{ instance.taskInstance.end | date: 'dd/MM HH:mm' }}
        </campus-folder-details>
      </campus-folder>
    </campus-list-view>
  </div>
</ng-container>
