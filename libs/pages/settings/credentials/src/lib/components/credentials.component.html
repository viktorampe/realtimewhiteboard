<div class="campus-page">
  <campus-page-header
    [title]="'Instellingen'"
    [subtitle]="'Mijn koppelingen'"
    [iconClass]="'link'"
  >
  </campus-page-header>

  <div class="page-settings-credentials__box">
    <campus-info-panel
      [titleText]="'Nieuwe koppeling maken'"
      [titleIcon]="'link'"
      [titleRightRouterLink]="['/settings']"
    >
      <mat-icon
        title__right
        class="info-panel__title--left__icon"
        [svgIcon]="'arrow-back'"
      ></mat-icon>
      <div title__right>Instellingen</div>
      <div class="page-settings-credentials__box__content">
        <p>Maak een koppeling met:</p>
        <div class="page-settings-credentials__box__content__ssolinks">
          <campus-button
            *ngFor="let ssolink of (ssoLinks$ | async)"
            [iconClass]="ssolink.logoIcon"
            class="{{ ssolink.className }}"
            (click)="addCredential(ssolink)"
            >{{ ssolink.name }}</campus-button
          >
        </div>
      </div>
    </campus-info-panel>
  </div>

  <div class="page-settings-credentials__box">
    <campus-info-panel
      [titleText]="'Mijn koppelingen'"
      [titleIcon]="'settings-cog'"
    >
      <div class="page-settings-credentials__box__content">
        <ng-container
          *ngIf="(credentials$ | async) as credentials; else: noProfiles"
        >
          <ng-container *ngIf="credentials.length > 0; else: noProfiles">
            <div *ngFor="let credential of credentials">
              <campus-person-summary
                *ngIf="credential.profile"
                [person]="credential | PersonBadgeFromCredential"
                [connectionTypeIcon]="credential.providerLogo"
              >
                <div description>
                  <p>
                    <span
                      *ngIf="
                        credential.profile.emails &&
                        credential.profile.emails[0]
                      "
                    >
                      - <mat-icon icon [svgIcon]="'mail'"></mat-icon>
                      <a href="credential | MailToByCredential">{{
                        credential.profile.emails[0].value + '-'
                      }}</a>
                    </span>
                    Laatste update: {{ credential.modified | humanDateTime }}
                  </p>
                </div>
                <campus-button
                  campusRoundedCorners
                  *ngIf="credential.profile.avatar"
                  (click)="changeAvatar(credential)"
                  >Gebruik profielfoto</campus-button
                >
                <campus-button
                  campusRoundedCorners
                  (click)="decoupleCredential(credential)"
                  >Loskoppelen</campus-button
                >
              </campus-person-summary>
            </div>
          </ng-container>
        </ng-container>
        <ng-template #noProfiles>
          <p>U hebt nog geen externe profielen gekoppeld.</p>
        </ng-template>
      </div>
    </campus-info-panel>
  </div>
</div>
