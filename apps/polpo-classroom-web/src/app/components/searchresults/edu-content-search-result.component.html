<div class="app-educontentsearchresult" [ngClass]="{ selected: isSelected }">
  <div class="app-educontentsearchresult__top">
    <campus-file-extension
      *ngIf="data.eduContent.previewImage === ''"
      [extensionClass]="data.eduContent.publishedEduContentMetadata.fileExt"
    ></campus-file-extension>
    <div
      class="app-educontentsearchresult__top__thumbnail"
      *ngIf="data.eduContent.previewImage !== ''"
      [style.backgroundImage]="'url(' + data.eduContent.previewImage + ')'"
    ></div>
    <div class="app-educontentsearchresult__top__details">
      <header class="app-educontentsearchresult__top__details__header">
        <div class="app-educontentsearchresult__top__details__header__title"
          ><mat-icon
            [svgIcon]="
              data.eduContent.publishedEduContentMetadata.eduContentProductType
                .icon
            "
          ></mat-icon>
          <span> {{ data.eduContent.publishedEduContentMetadata.title }} </span>
        </div>
        <div class="app-educontentsearchresult__top__details__header__icons">
          <mat-icon
            matTooltip="Al toegevoegd aan de taak"
            *ngIf="data.inTask"
            svgIcon="check-on"
          ></mat-icon>
          <mat-icon
            matTooltip="Al toegevoegd aan de bundel"
            *ngIf="data.inBundle"
            svgIcon="check-on"
          ></mat-icon>
          <mat-icon
            matTooltip="Gekoppeld aan een bordboek"
            *ngIf="
              data.eduContent.publishedEduContentMetadata.eduContentTOC &&
              data.eduContent.publishedEduContentMetadata.eduContentTOC.length
            "
            svgIcon="book"
          ></mat-icon>
          <mat-icon
            matTooltip="Pedagogisch materiaal"
            *ngIf="
              data.eduContent.publishedEduContentMetadata.eduContentProductType
                .pedagogic
            "
            svgIcon="student"
          ></mat-icon>
        </div>
      </header>
      <p class="app-educontentsearchresult__top__details__content">
        {{ data.eduContent.publishedEduContentMetadata.description }}
      </p>
      <div class="app-educontentsearchresult__top__details__methods">
        <span
          *ngFor="
            let method of data.eduContent.publishedEduContentMetadata.methods
          "
          [class]="
            'campus-method__logo' +
            (isSelected ? ' campus-method__logo--color ' : ' ') +
            method.icon
          "
        ></span>
      </div>
      <footer class="app-educontentsearchresult__top__details__footer">
        <span
          >Jaar
          {{ data.eduContent.publishedEduContentMetadata.years | join: 'name' }}
        </span>
        |
        <span
          >{{
            data.eduContent.publishedEduContentMetadata.schoolTypes
              | join: 'name':' - '
          }}
        </span>
        |
        <span
          >{{
            data.eduContent.publishedEduContentMetadata.eduNets
              | join: 'code':' - '
          }}
        </span>
        |
        <span>{{ data.eduContent.publishedEduContentMetadata.language }}</span>
      </footer>
    </div>
  </div>
  <div
    @collapseExpandTrigger
    *ngIf="isSelected"
    class="app-educontentsearchresult__bottom"
  >
    <div class="app-educontentsearchresult__bottom__contents">
      <div class="app-educontentsearchresult__bottom__contents__producttype">
        <mat-icon
          [svgIcon]="
            data.eduContent.publishedEduContentMetadata.eduContentProductType
              .icon
          "
        ></mat-icon>
        =
        {{
          data.eduContent.publishedEduContentMetadata.eduContentProductType.name
        }}
      </div>
      <div
        *ngIf="
          data.eduContent.publishedEduContentMetadata.eduContentTOC &&
          data.eduContent.publishedEduContentMetadata.eduContentTOC.length
        "
        class="app-educontentsearchresult__bottom__contents__tocheader"
      >
        <mat-icon svgIcon="book"></mat-icon> = Dit is materiaal dat je kan
        gebruiken bij:
      </div>
      <div
        *ngIf="
          data.eduContent.publishedEduContentMetadata.eduContentTOC &&
          data.eduContent.publishedEduContentMetadata.eduContentTOC.length
        "
        class="app-educontentsearchresult__bottom__contents__toc"
      >
        <div *ngFor="let book of getNormalizedEduContentToc()">
          <span>{{ book.title }}</span>
          <ul>
            <li
              *ngFor="let toc of book.tocs"
              [class]="'toc-depth-' + toc.depth"
            >
              {{ toc.title }}
            </li>
          </ul>
        </div>
      </div>
      <div
        *ngIf="
          data.eduContent.publishedEduContentMetadata.eduContentProductType
            .pedagogic
        "
        class="app-educontentsearchresult__bottom__contents__pedagogic"
      >
        <mat-icon svgIcon="student"></mat-icon> = Dit is pedagogisch materiaal:
        dit is niet voor leerlingen bestemd
      </div>
    </div>
    <div class="app-educontentsearchresult__bottom__buttonbar">
      <campus-button
        *ngIf="
          data.eduContent.publishedEduContentMetadata.fileExt !== 'ludo.zip'
        "
        (click)="openStatic()"
        iconClass="bundles"
        clickStopPropagation
        >Bekijken
      </campus-button>
      <campus-button
        *ngIf="
          data.eduContent.publishedEduContentMetadata.fileExt === 'ludo.zip'
        "
        (click)="openExercise(false)"
        iconClass="eye"
        clickStopPropagation
        >Bekijken
      </campus-button>
      <campus-button
        *ngIf="!data.currentTask && !data.inBundle"
        (click)="linkBundle()"
        iconClass="bundles"
        clickStopPropagation
        >Toevoegen aan bundel
      </campus-button>
      <campus-button
        *ngIf="data.inBundle"
        (click)="unlinkBundle()"
        iconClass="bundles"
        clickStopPropagation
        >Verwijderen uit bundel
      </campus-button>
      <campus-button
        *ngIf="
          !data.currentBundle &&
          (!data.inTask &&
            data.eduContent.publishedEduContentMetadata.taskAllowed)
        "
        (click)="linkTask()"
        iconClass="task"
        clickStopPropagation
        >Toevoegen aan taak
      </campus-button>
      <campus-button
        *ngIf="data.inTask"
        (click)="unlinkTask()"
        iconClass="task"
        clickStopPropagation
        >Verwijderen uit taak
      </campus-button>
      <campus-button
        (click)="toggleFavorite()"
        iconClass="favorites"
        clickStopPropagation
      >
        {{
          data.isFavorite
            ? 'Verwijderen uit favorieten'
            : 'Toevoegen aan favorieten'
        }}
      </campus-button>
    </div>
  </div>
</div>
